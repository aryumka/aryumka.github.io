"use strict";(self.webpackChunkaryumka_me=self.webpackChunkaryumka_me||[]).push([[8028],{3737:function(n,a,s){s.r(a);var e=s(9128),t=s(9474);function o(n){const a=Object.assign({p:"p",span:"span",a:"a",img:"img",strong:"strong"},(0,e.R)(),n.components);return t.createElement(t.Fragment,null,t.createElement(a.p,null,t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MySQL</code>'}}),"에서 음수가 될 수 있는 칼럼를 쿼리로 피벗할 때 의도된 NULL을 사용한다. ",t.createElement(a.a,{href:"https://www.oracle.com/technical-resources/articles/database/sql-11g-pivot.html",rel:"nofollow noopener noreferrer"},"오라클의 경우 11g 이상부터 내장된 PIVOT() 함수를 제공한다."),"\n예를 들어 아래와 같은 테이블 A에서 조회한다고 하자.\n",t.createElement(a.img,{src:"https://velog.velcdn.com/images/aryumka/post/cde0baa0-dccc-410e-9111-72094800f25b/image.png",alt:""})),"\n",t.createElement(a.p,null,"위의 형태를 아래와 같이 피벗하는 경우\n",t.createElement(a.img,{src:"https://velog.velcdn.com/images/aryumka/post/12217603-9856-445a-95ac-565b54c277e9/image.png",alt:""})),"\n",t.createElement(a.p,null,"개인적으로 데이터를 피벗할 칼럼만큼의 ROW수 만큼 나오도록 IF()를 사용하여 펼친 후 다시 ",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MAX</code>'}})," 또는 ",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">SUM</code>'}})," 등의 집계함수를 통해 ",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">GROUP BY</code>'}}),"로 압축하는 방법을 즐겨 쓴다.\n쿼리는 아래와 같다."),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> \n   펀드코드<span class="token punctuation">,</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'01\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간<span class="token number">1</span>별수익률<span class="token punctuation">,</span>\n   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'06\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간N별수익률<span class="token punctuation">,</span>\n<span class="token keyword">FROM</span> A\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 펀드코드<span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(a.p,null,"그러나 위와 같이 IF()함수의 ELSE인자로 0을 넣었을 때 음수를 고려하지 않은 부정확한 값이 나온다. 음수값일 경우 0보다 작으므로 MAX조건으로 걸리지 않기 때문이다.\n",t.createElement(a.img,{src:"https://velog.velcdn.com/images/aryumka/post/530e0979-f392-419b-8d0f-5ad0739f0f73/image.png",alt:""}),"\n따라서 아래처럼 의도적으로 NULL을 넣어주면"),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> \n   펀드코드<span class="token punctuation">,</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'01\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간<span class="token number">1</span>별수익률<span class="token punctuation">,</span>\n   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'06\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간N별수익률<span class="token punctuation">,</span>\n<span class="token keyword">FROM</span> A\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 펀드코드<span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(a.img,{src:"https://velog.velcdn.com/images/aryumka/post/35bdb3fa-06e2-4642-ba74-2cc6a4ca1ea2/image.png",alt:""}),"\n",t.createElement(a.p,null,t.createElement(a.strong,null,"음수가 null보다 상위로 정렬"),"되어 원하는 값을 얻을 수 있다."),"\n",t.createElement(a.p,null,"NULL을 리턴하는 것은 대개 바람직하지 않은 practice라고 느껴진다. 그래서 default로 0을 자연스럽게 넣게 된다.\n때문에 더욱 무의식적으로 실수하기 쉬운 부분이니 기록해두고 잊지 말아야겠다."))}a.default=function(n){void 0===n&&(n={});const{wrapper:a}=Object.assign({},(0,e.R)(),n.components);return a?t.createElement(a,n,t.createElement(o,n)):o(n)}},3471:function(n,a,s){s.r(a),s.d(a,{default:function(){return E}});var e=s(3737),t=s(5530),o=s(9474),p=s(8844),c=s(1047),l=s(8928),r=s.n(l),u=s(3893),i=s(2887),m=s(5909),k=s(589),g=s(5181),d=s.n(g),f=s(2195),y=s(6810);r().extend(s(1997));const h=n=>{let{data:a,location:s,pageContext:e,children:t}=n;const{tableOfContents:l,fields:g,frontmatter:h,excerpt:E}=a.mdx,{series:w}=e,v=r()(g.date).locale("ko").format(),L={headline:h.title,dateModified:v,datePublished:v,image:""+s.href+h.image,mainEntityOfPage:{"@type":"WebPage","@id":s.href},author:{"@type":"Person",name:"Lee Sun-Hyoup"},url:s.href,description:E,"@type":"BlogPosting","@context":"https://schema.org"};(0,o.useEffect)((()=>{void 0!==typeof document&&d()((function(){d()(".post-container a[data-footnote-ref]").each(((n,a)=>{var s;const e=null===(s=d()(a).attr("href"))||void 0===s?void 0:s.slice(1),t=d()("#"+e).text().replace("↩","");d()(a).attr("data-tooltip",t)}))}))}),[]);const{0:A,1:M}=(0,o.useState)();(0,o.useEffect)((()=>{M(a.allMdx.edges.filter((n=>n.node.fields.slug!==g.slug)).sort((()=>Math.random()-.5)).slice(0,6))}),[]);const S=h.draft&&!0;return(0,y.Y)(p.A,null,(0,y.Y)(c.A,{title:h.title,description:E,meta:[{name:"article:published_time",content:r()(g.date).locale("ko").format()},{name:"image",content:"https://aryumka.me"+h.image},{property:"og:image",content:"https://aryumka.me"+h.image},{property:"og:image:secure_url",content:"https://aryumka.me"+h.image}]}),(0,y.Y)(k.m,null,(0,y.Y)("script",{type:"application/ld+json"},JSON.stringify(L))),(0,y.Y)("h1",{className:"post-title"},h.title),(0,y.Y)("span",{className:"post-date"},"Written on ",r()(g.date).locale("en").format("LL")),(0,y.Y)("img",{src:h.image,style:{objectFit:"cover",maxHeight:300,width:"100%"}}),S||l.items&&(0,y.Y)(m.A,{items:l.items}),S||(null==w?void 0:w.items)&&(0,y.Y)(f.A,{title:w.title,items:w.items,currentItem:h.title}),(0,y.Y)("div",{className:"post-content"},S?(0,y.Y)(b,null,"Not yet published"):t),(0,y.Y)(u.A,{tags:h.tags,comment:h.comments}),A&&(0,y.Y)(i.A,{posts:A,current:g.slug}))};function E(n){return o.createElement(h,n,o.createElement(e.default,n))}const b=(0,t.A)("div",{target:"ezegrm70"})({name:"xl5zip",styles:"margin:16px 0;font-weight:bold;font-size:20px;text-align:center"})}}]);
//# sourceMappingURL=component---src-templates-post-tsx-content-file-path-src-posts-2024-01-24-query-if-null-return-mdx-98988a734fb87367e07a.js.map