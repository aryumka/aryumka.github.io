"use strict";(self.webpackChunkaryumka_me=self.webpackChunkaryumka_me||[]).push([[8028],{3737:function(n,a,e){e.r(a);var t=e(9128),s=e(9474),o=e(5799);function p(n){const a=Object.assign({p:"p",span:"span",a:"a",strong:"strong"},(0,t.R)(),n.components);return s.createElement(s.Fragment,null,s.createElement(a.p,null,s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MySQL</code>'}}),"에서 음수가 될 수 있는 칼럼를 쿼리로 피벗할 때 의도된 NULL을 사용한다. ",s.createElement(a.a,{href:"https://www.oracle.com/technical-resources/articles/database/sql-11g-pivot.html",rel:"nofollow noopener noreferrer"},"오라클의 경우 11g 이상부터 내장된 PIVOT() 함수를 제공한다."),"\n예를 들어 아래와 같은 테이블 A에서 조회한다고 하자."),"\n",s.createElement(o.A,{src:"https://velog.velcdn.com/images/aryumka/post/cde0baa0-dccc-410e-9111-72094800f25b/image.png"}),"\n",s.createElement(a.p,null,"위의 형태를 아래와 같이 피벗하는 경우"),"\n",s.createElement(o.A,{src:"https://velog.velcdn.com/images/aryumka/post/12217603-9856-445a-95ac-565b54c277e9/image.png"}),"\n",s.createElement(a.p,null,"개인적으로 데이터를 피벗할 칼럼만큼의 ROW수 만큼 나오도록 IF()를 사용하여 펼친 후 다시 ",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">MAX</code>'}})," 또는 ",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">SUM</code>'}})," 등의 집계함수를 통해 ",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">GROUP BY</code>'}}),"로 압축하는 방법을 즐겨 쓴다.\n쿼리는 아래와 같다."),"\n",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> \n   펀드코드<span class="token punctuation">,</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'01\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간<span class="token number">1</span>별수익률<span class="token punctuation">,</span>\n   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'06\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간N별수익률<span class="token punctuation">,</span>\n<span class="token keyword">FROM</span> A\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 펀드코드<span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(a.p,null,"그러나 위와 같이 IF()함수의 ELSE인자로 0을 넣었을 때 음수를 고려하지 않은 부정확한 값이 나온다. 음수값일 경우 0보다 작으므로 MAX조건으로 걸리지 않기 때문이다."),"\n",s.createElement(o.A,{src:"https://velog.velcdn.com/images/aryumka/post/530e0979-f392-419b-8d0f-5ad0739f0f73/image.png"}),"\n",s.createElement(a.p,null,"따라서 아래처럼 의도적으로 NULL을 넣어주면"),"\n",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> \n   펀드코드<span class="token punctuation">,</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'01\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간<span class="token number">1</span>별수익률<span class="token punctuation">,</span>\n   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n   <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>기간구분코드 <span class="token operator">=</span> <span class="token string">\'06\'</span><span class="token punctuation">,</span> 수익률<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 기간N별수익률<span class="token punctuation">,</span>\n<span class="token keyword">FROM</span> A\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 펀드코드<span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(o.A,{src:"https://velog.velcdn.com/images/aryumka/post/35bdb3fa-06e2-4642-ba74-2cc6a4ca1ea2/image.png"}),"\n",s.createElement(a.p,null,s.createElement(a.strong,null,"음수가 null보다 상위로 정렬"),"되어 원하는 값을 얻을 수 있다."),"\n",s.createElement(a.p,null,"NULL을 리턴하는 것은 대개 바람직하지 않은 practice라고 느껴진다. 그래서 default로 0을 자연스럽게 넣게 된다.\n때문에 더욱 무의식적으로 실수하기 쉬운 부분이니 기록해두고 잊지 말아야겠다."))}a.default=function(n){void 0===n&&(n={});const{wrapper:a}=Object.assign({},(0,t.R)(),n.components);return a?s.createElement(a,n,s.createElement(p,n)):p(n)}},8164:function(n,a,e){e.r(a),e.d(a,{default:function(){return b}});var t=e(3737),s=e(5530),o=e(9474),p=e(8844),c=e(1047),l=e(8928),r=e.n(l),u=e(3893),i=e(2887),m=e(5909),d=e(589),k=e(5181),g=e.n(k),f=e(2195),h=e(6810);r().extend(e(1997));const y=n=>{let{data:a,location:e,pageContext:t,children:s}=n;const{tableOfContents:l,fields:k,frontmatter:y,excerpt:b}=a.mdx,{series:w}=t,v=r()(k.date).locale("ko").format(),A={headline:y.title,dateModified:v,datePublished:v,image:""+e.href+y.image,mainEntityOfPage:{"@type":"WebPage","@id":e.href},author:{"@type":"Person",name:"Lee Sun-Hyoup"},url:e.href,description:b,"@type":"BlogPosting","@context":"https://schema.org"};(0,o.useEffect)((()=>{void 0!==typeof document&&g()((function(){g()(".post-container a[data-footnote-ref]").each(((n,a)=>{var e;const t=null===(e=g()(a).attr("href"))||void 0===e?void 0:e.slice(1),s=g()("#"+t).text().replace("↩","");g()(a).attr("data-tooltip",s)}))}))}),[]);const{0:L,1:Y}=(0,o.useState)();(0,o.useEffect)((()=>{Y(a.allMdx.edges.filter((n=>n.node.fields.slug!==k.slug)).sort((()=>Math.random()-.5)).slice(0,6))}),[]);const x=y.draft&&!0;return(0,h.Y)(p.A,null,(0,h.Y)(c.A,{title:y.title,description:b,meta:[{name:"article:published_time",content:r()(k.date).locale("ko").format()},{name:"image",content:"https://aryumka.me"+y.image},{property:"og:image",content:"https://aryumka.me"+y.image},{property:"og:image:secure_url",content:"https://aryumka.me"+y.image}]}),(0,h.Y)(d.m,null,(0,h.Y)("script",{type:"application/ld+json"},JSON.stringify(A))),(0,h.Y)("h1",{className:"post-title"},y.title),(0,h.Y)("span",{className:"post-date"},"Written on ",r()(k.date).locale("en").format("LL")),(0,h.Y)("img",{src:y.image,style:{objectFit:"cover",maxHeight:300,width:"100%"}}),x||l.items&&(0,h.Y)(m.A,{items:l.items}),x||(null==w?void 0:w.items)&&(0,h.Y)(f.A,{title:w.title,items:w.items,currentItem:y.title}),(0,h.Y)("div",{className:"post-content"},x?(0,h.Y)(E,null,"Not yet published"):s),(0,h.Y)(u.A,{tags:y.tags,comment:y.comments}),L&&(0,h.Y)(i.A,{posts:L,current:k.slug}))};function b(n){return o.createElement(y,n,o.createElement(t.default,n))}const E=(0,s.A)("div",{target:"ezegrm70"})({name:"xl5zip",styles:"margin:16px 0;font-weight:bold;font-size:20px;text-align:center"})},5799:function(n,a,e){var t=e(9474),s=e(1615),o=e(6810);a.A=n=>{let{src:a,caption:e,width:p,expandable:c}=n;const{0:l,1:r}=(0,t.useState)(!1);return(0,o.Y)("figure",null,(0,o.Y)("img",{src:a,width:p,style:{cursor:c?"zoom-in":"default"},onClick:c?()=>r(!0):void 0}),e&&(0,o.Y)("figcaption",{dangerouslySetInnerHTML:{__html:e}}),l&&s.createPortal((0,o.Y)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",cursor:"zoom-out",backgroundColor:"rgba(0, 0, 0, 0.7)"},onClick:()=>r(!1)},(0,o.Y)("div",{style:{borderRadius:8,maxWidth:1200,width:"80%",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white"}},(0,o.Y)("img",{src:a,width:"100%"}))),document.body))}}}]);
//# sourceMappingURL=component---src-templates-post-tsx-content-file-path-src-posts-2024-01-24-query-if-null-return-mdx-5bcb91987bcb37d796ca.js.map